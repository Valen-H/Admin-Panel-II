"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const url = tslib_1.__importStar(require("url"));
module.exports = {
    name: "command",
    afters: ["auth"],
    befores: ["fix", "directory", "static", "end"],
    _fromFile: true,
    body: async function body(req, res, event) {
        let uri = new url.URL(`http://127.0.0.1:${event.server.opts.port}${req.url}`);
        if (uri.pathname === "/kill") {
            let time = uri.searchParams.get("time"), code = uri.searchParams.get("code");
            res.end("DONE");
            event.stop();
            await event.server.data["parent"].cmds.find(cmd => cmd.name === "kill").body(time, code);
        }
        return event.pass();
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tbWFuZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9taWRkbGV3YXJlcy9jb21tYW5kLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUVBLGlEQUEyQjtBQUUzQixNQUFNLENBQUMsT0FBTyxHQUFHO0lBQ2hCLElBQUksRUFBRSxTQUFTO0lBQ2YsTUFBTSxFQUFFLENBQUMsTUFBTSxDQUFDO0lBQ2hCLE9BQU8sRUFBRSxDQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsUUFBUSxFQUFFLEtBQUssQ0FBRTtJQUNoRCxTQUFTLEVBQUUsSUFBSTtJQUNmLElBQUksRUFBRSxLQUFLLFVBQVUsSUFBSSxDQUFDLEdBQXlCLEVBQUUsR0FBd0IsRUFBRSxLQUF3QjtRQUN0RyxJQUFJLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxHQUFHLENBQUMsb0JBQW9CLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUU5RSxJQUFJLEdBQUcsQ0FBQyxRQUFRLEtBQUssT0FBTyxFQUFFO1lBQzdCLElBQUksSUFBSSxHQUFHLEdBQUcsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUN0QyxJQUFJLEdBQUcsR0FBRyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDckMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNoQixLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDYixNQUFNLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxLQUFLLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDekY7UUFFRCxPQUFPLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNyQixDQUFDO0NBQ0QsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGh0dHAgZnJvbSBcImh0dHBcIjtcbmltcG9ydCAqIGFzIHZzZXJ2IGZyb20gXCJ2YWxlLXNlcnZlci1paVwiO1xuaW1wb3J0ICogYXMgdXJsIGZyb20gXCJ1cmxcIjtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cdG5hbWU6IFwiY29tbWFuZFwiLFxuXHRhZnRlcnM6IFtcImF1dGhcIl0sXG5cdGJlZm9yZXM6IFsgXCJmaXhcIiwgXCJkaXJlY3RvcnlcIiwgXCJzdGF0aWNcIiwgXCJlbmRcIiBdLFxuXHRfZnJvbUZpbGU6IHRydWUsXG5cdGJvZHk6IGFzeW5jIGZ1bmN0aW9uIGJvZHkocmVxOiBodHRwLkluY29taW5nTWVzc2FnZSwgcmVzOiBodHRwLlNlcnZlclJlc3BvbnNlLCBldmVudDogdnNlcnYuQ2xhc3Nlcy5ldnQpOiBQcm9taXNlPGJvb2xlYW4+IHtcblx0XHRsZXQgdXJpID0gbmV3IHVybC5VUkwoYGh0dHA6Ly8xMjcuMC4wLjE6JHtldmVudC5zZXJ2ZXIub3B0cy5wb3J0fSR7cmVxLnVybH1gKTtcblx0XHRcblx0XHRpZiAodXJpLnBhdGhuYW1lID09PSBcIi9raWxsXCIpIHtcblx0XHRcdGxldCB0aW1lID0gdXJpLnNlYXJjaFBhcmFtcy5nZXQoXCJ0aW1lXCIpLFxuXHRcdFx0XHRjb2RlID0gdXJpLnNlYXJjaFBhcmFtcy5nZXQoXCJjb2RlXCIpO1xuXHRcdFx0cmVzLmVuZChcIkRPTkVcIik7XG5cdFx0XHRldmVudC5zdG9wKCk7XG5cdFx0XHRhd2FpdCBldmVudC5zZXJ2ZXIuZGF0YVtcInBhcmVudFwiXS5jbWRzLmZpbmQoY21kID0+IGNtZC5uYW1lID09PSBcImtpbGxcIikuYm9keSh0aW1lLCBjb2RlKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZXZlbnQucGFzcygpO1xuXHR9XG59O1xuIl19